# Boomerang - WordPress Project

Этот проект представляет собой стандартную установку WordPress с кастомным плагином. Весь проект включает в себя все необходимые файлы, темы, плагины и базу данных. Данный репозиторий можно использовать для быстрого развертывания WordPress-сайта с поддержкой Redis кэширования.


## Требования

- [Docker](https://www.docker.com/) и [Docker Compose](https://docs.docker.com/compose/) должны быть установлены на вашем компьютере.
- Git для клонирования репозитория.


## Установка

1. **Клонируйте репозиторий:**

    Сначала клонируйте репозиторий на ваш компьютер:
    
    ```bash
    git clone https://github.com/Kromvel-X/boomerang.git
    cd boomerang
     ```
 
2.	**Запустите контейнеры с помощью Docker Compose:**

    Убедитесь, что у вас установлены Docker и Docker Compose. После этого выполните команду для поднятия всех контейнеров:

    ```
    docker-compose up -d
    ```

3. **Посетите сайт:**

    http://localhost:8000
    
    Это откроет ваш локальный WordPress сайт.
    
    **Доступ к админке сайта:**
    http://localhost:8000/wp-admin 
    
    
    ```
    логин: boomerang
    пароль: sr0X(Jws0f4wcVQdv^
    ```

## Описания разработнных плагинов ##

1.  bonus-form - создает блок bonus-form, при помощи пакета - @wordpress/create-block 

2.  slot-catalog - Создает 2 шорткода: 
    
    - [slot-catalog] - выводит форму поиска, кнопку "Провайдеры" и список категорий (слайдер).
    - [slot-slider] - выводит слайдер слотов.

**Структура плагина:** 

    ├── assets/        # Статические файлы (CSS, JS, Less, изображения)
    ├── src/           # Исходный код
    │   ├── API/       # Классы API (AJAX, REST API)
    │   ├── Core/      # Базовые классы
    │   ├── Frontend/  # Логика фронтенда
    │   ├── Query/     # WP_Query-запросы
    │   ├── templates/ # Шаблоны вывода данных
    └── slot-catalog.php  # Основной файл плагина

## Описания кастомной темы ##
Название - Boomerang
Основной файл для работы с темой /inc/BoomerangBase.php:
Представляет собой конфигурационный класс BoomerangBase. 

## Работа с PHP-скриптами

1. **Регулирование количества слотов**

    •	Используйте параметр count в URL для регулирования количества отображаемых слотов:
    
    http://localhost:8000/?count=5


2. **Сортировка слотов**

    •	Используйте параметр sort для сортировки слотов:

    http://localhost:8000/?sort=asc

    http://localhost:8000/?sort=desc

    http://localhost:8000/?sort=random

3. **Поиск слотов**

    •	$_GET запрос: Используйте параметр title для поиска слотов: 
            http://localhost:8000/?title=slot 1

    •	AJAX: поисковая форма: работает на ввод данных в input.

4. **Фильтрация слотов**

    •	AJAX: "Провайдеры" раскрывает дропдаун с категориями (дочернии категории от категории "Провайдеры"), при клике на элемент дропдаунна, происходит полученние записей с определенной категорией.
    
    •	AJAX: Слайдер категорий (дочернии категории от категории "Игры"), при клике на кнопку категории, происходит полученние записей с определенной категорией.


## Кастомный API ##

Кастомный роут /wp-json/testtask/v1/slots/get возвращает JSON с данными о слотах:

http://localhost:8000/wp-json/testtask/v1/slots/get


Можно регулировать количество постов с помощью параметра per_page

http://localhost:8000/wp-json/testtask/v1/slots/get?per_page=1


Пример ответа:
```json
[
    {
        "name": "Slot 7",
        "thumb": "http://localhost:8000/wp-content/uploads/2025/03/slot_2x.webp",
        "slug": "slot-7"
    }
]
```

## Статический анализ кода для плагина Slot Catalog

Для повышения качества кода плагина **Slot Catalog** используется [PHPStan](https://phpstan.org/) —  инструмент статического анализа кода.

**Конфигурация:**

- Файл конфигурации: **`phpstan.neon`** (находится в корне проекта).

- Уровень проверки (Rule Level): **9** (предпоследний уровень).

- Анализируется только код плагина `Slot Catalog`.

***Почему это важно?***

PHPStan имеет **10 уровней анализа**, где **0 — самый мягкий, а 10 — самый строгий**. 

В плагине `Slot Catalog` используется **уровень 9**, что означает, что код проходит почти максимальный уровень проверки. 

Этот уровень:

- Требует строгой типизации.

- Обнаруживает потенциальные ошибки еще до их возникновения.

- Помогает писать код, соответствующий лучшим стандартам разработки.

***Запуск анализа:***
Перед выполнением статического анализа кода убедитесь, что все зависимости установлены. Для этого выполните команду:
```
composer install
```

Для выполнения проверки кода запустите следующую команду:
```
php -d memory_limit=512M vendor/bin/phpstan analyse   
```
    
## Структура проекта

    •	docker-compose.yml: Конфигурация для запуска контейнеров Docker.
    •	boomerang/: Каталог с wordpress, плагиномами, файлами темы.
    •	database.sql: База данных для WordPress.
    •	nginx.conf: Конфигурация Nginx для проксирования запросов к контейнеру WordPress.
    •	vendor/: Папка с зависимостями, установленными через Composer.

    
## Используемые технологии

    •	WordPress: CMS для создания и управления контентом.
    •	Redis: Используется для кэширования данных WordPress (Кешируются запросы к базе данных).
    •	MySQL: База данных для хранения данных сайта.
    •	Nginx: Прокси-сервер для обработки HTTP-запросов.
    •	Docker и Docker Compose: Используются для контейнеризации и упрощения развертывания проекта.
    •	Composer: Для управления зависимостями и автозагрузки классов.
    •	Gutenberg: Используется для создания и редактирования блоков в WordPress.
    •	AJAX: Для динамической загрузки и фильтрации слотов.
    •	PHPStan: Для повышения качества кода


## Примечания
При запуске проекта с помощью Docker Compose автоматически создаются все необходимые контейнеры, в том числе для базы данных и Redis.