"use strict";(()=>{function e(){const e=document.getElementById("providers"),t=document.getElementById("slot-results");e&&e.addEventListener("click",function(n){const o=n.target.closest(".provider__item");if(!o)return;const c=o.innerText;s("searchPostByCategory",c,t);const r=e.closest(".container").querySelector(".dropdown-btn");r.classList.toggle("active"),e.classList.toggle("active")})}function t(){const e=document.getElementById("search"),t=document.getElementById("slot-results"),n=document.getElementById("search-form");e&&(e.addEventListener("input",function(){const n=e.value.trim();s("searchPostsByTitle",n,t)}),n.addEventListener("submit",function(n){n.preventDefault();const o=e.value.trim();s("searchPostsByTitle",o,t)}))}function n(){const e=document.getElementById("category"),t=document.getElementById("slot-results");if(!e)return;const n=e.querySelectorAll(".category__button");n.forEach(e=>{e.addEventListener("click",function(){n.forEach(e=>e.classList.remove("active")),requestAnimationFrame(()=>e.classList.add("active"));const o=e.innerText;s("searchPostByCategory",o,t)})})}function s(e,t,n){let s=new FormData;s.append("action",e),s.append("search",t),s.append("nonce",slots_catalog.nonce),fetch(slots_catalog.ajaxurl,{method:"POST",body:s}).then(e=>e.json()).then(e=>{if(n.innerHTML="",e.length>0){const t=o(n);e.forEach(e=>{let t=e.tag?`<div class='badge'>${e.tag}</div>`:"",s=`\n                        <article class='col slot__col'>\n                            <a href="${e.link}" class='slot-card'>\n                                ${e.image}\n                                <div class='slot-card__content'>\n                                    <h3 class='slot-card__title'>${e.title}</h3>\n                                    ${t}\n                                    <span class='slot-card__favourites'></span>\n                                </div>\n                                <div class='slot-card__hover'>\n                                    <span class='slot-card__icon'></span>\n                                    <p class='slot-card__desc'>${e.content}</p>\n                                </div>\n                            </a>\n                        </article>\n                    `;n.insertAdjacentHTML("beforeend",s)}),setTimeout(()=>t.disconnect(),100)}else n.innerHTML="<p>Ничего не найдено</p>"}).catch(e=>console.error("Ошибка при запросе:",e))}function o(e){const t=new MutationObserver((t,n)=>{t.forEach(t=>{if("childList"===t.type){let t=e.querySelectorAll(".lazy_load");t.forEach(e=>{e.srcset=e.dataset.srcset,e.removeAttribute("data-srcset"),e.classList.remove("lazy_load")})}})});return t.observe(e,{childList:!0}),t}function c(){if("IntersectionObserver"in window){var e=document.querySelectorAll(".slider");e.forEach(e=>{var t=new IntersectionObserver(function(e){e.forEach(e=>{e.isIntersecting&&(r(),t.disconnect())})},{root:null,rootMargin:"200px",threshold:0});t.observe(e)})}}function r(){var e="/wp-content/plugins/slot-catalog/assets/js/tiny-slider.js",t=document.createElement("script");t.src=e,t.defer=!0,document.body.appendChild(t);var n="/wp-content/plugins/slot-catalog/assets/css/tiny-slider.css",s=document.createElement("link");s.rel="stylesheet",s.href=n,document.body.appendChild(s),t.onload=function(){if("function"==typeof tns)tns({container:"#category",items:1,slideBy:1,mouseDrag:!0,autoWidth:!0,gutter:10,controls:!1,nav:!1,loop:!1,preventScrollOnTouch:"force"}),tns({container:"#sliderSlots",items:2,slideBy:1,mouseDrag:!0,gutter:0,controls:!1,nav:!1,loop:!1,preventScrollOnTouch:"force",responsive:{380:{items:2},768:{items:3},1024:{items:4},1280:{items:6},1440:{items:7}}});else console.error("Ошибка: tns() не найден!")}}window.addEventListener("load",function(){t(),e(),n(),c()})})();